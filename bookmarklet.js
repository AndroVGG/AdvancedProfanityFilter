/*! For license information please see bookmarkletFilter.js.LICENSE.txt */
(()=>{var e={392:(e,t,s)=>{"use strict";var i=u(s(357)),o=u(s(50)),a=u(s(394)),r=u(s(470)),n=u(s(210)),d=u(s(863)),l=u(s(709));function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}s(894);const h={runtime:{}};h.runtime.sendMessage=e=>{};
/* @preserve - Start User Config */
const p=d.default._defaults;p.words=d.default._defaultWords;
/* @preserve - End User Config */
class m extends a.default{constructor(){super(),c(this,"audio",void 0),c(this,"audioOnly",void 0),c(this,"audioWordlistId",void 0),c(this,"cfg",void 0),c(this,"domain",void 0),c(this,"hostname",void 0),c(this,"iframe",void 0),c(this,"location",void 0),c(this,"mutePage",void 0),c(this,"observer",void 0),c(this,"processMutationTarget",void 0),c(this,"processNode",void 0),c(this,"shadowObserver",void 0),this.audioWordlistId=0,this.mutePage=!1,this.processMutationTarget=!1}advancedReplaceText(e,t,s=!0){e.parentNode||e===document?this.wordlists[t].regExps.forEach((i=>{findAndReplaceDOMText(e,{preset:"prose",find:i,replace:(e,i)=>0===e.index?this.replaceText(i[0],t,s):""})})):this.cleanText(e,t,s)}checkMutationForProfanity(e){e.addedNodes.forEach((e=>{r.default.isForbiddenNode(e)||(this.mutePage?this.cleanAudio(e):this.audioOnly||this.processNode(e,this.wordlistId))})),this.mutePage&&this.audio.muted&&e.removedNodes.forEach((e=>{const t=this.audio.supportedNode(e),s=!1!==t?this.audio.rules[t]:this.audio.rules[0];(!1!==t||e==this.audio.lastFilteredNode||e.contains(this.audio.lastFilteredNode)||s.simpleUnmute&&this.audio.lastFilteredText&&this.audio.lastFilteredText.includes(e.textContent))&&this.audio.unmute(s)})),e.target&&("#text"===e.target.nodeName?this.checkMutationTargetTextForProfanity(e):this.processMutationTarget&&this.processNode(e.target,this.wordlistId))}checkMutationTargetTextForProfanity(e){if(!r.default.isForbiddenNode(e.target))if(this.mutePage){const t=this.audio.supportedNode(e.target),s=!1!==t?this.audio.rules[t]:this.audio.rules[0];if(!1!==t&&s.simpleUnmute)this.audio.muted&&e.oldValue&&this.audio.lastFilteredText&&this.audio.lastFilteredText.includes(e.oldValue)&&this.audio.unmute(s),this.audio.clean(e.target,t);else if(s.simpleUnmute&&this.audio.muted&&!e.target.parentElement)this.audio.lastFilteredText&&this.audio.lastFilteredText.includes(e.target.textContent)&&this.audio.unmute(s);else if(!this.audioOnly){const t=this.replaceTextResult(e.target.data,this.wordlistId);t.modified&&(e.target.data=t.filtered)}}else if(!this.audioOnly){const t=this.replaceTextResult(e.target.data,this.wordlistId);t.modified&&(e.target.data=t.filtered)}}cleanAudio(e){if(this.audio.youTube&&this.audio.youTubeAutoSubsPresent())this.audio.youTubeAutoSubsSupportedNode(e)?this.audio.youTubeAutoSubsCurrentRow(e)?this.audio.cleanYouTubeAutoSubs(e):this.audioOnly||this.processNode(e,this.wordlistId):this.audioOnly||this.audio.youTubeAutoSubsNodeIsSubtitleText(e)||this.processNode(e,this.wordlistId);else{const t=this.audio.supportedNode(e);!1!==t?this.audio.clean(e,t):this.audioOnly||this.processNode(e,this.wordlistId)}}cleanChildNode(e,t,s=!0){if(e.nodeName)if(e.textContent&&""!=e.textContent.trim()){const i=this.replaceTextResult(e.textContent,t,s);i.modified&&(e.textContent=i.filtered)}else"IMG"==e.nodeName?(""!=e.alt&&(e.alt=this.replaceText(e.alt,t,s)),""!=e.title&&(e.title=this.replaceText(e.title,t,s))):e.shadowRoot&&this.filterShadowRoot(e.shadowRoot,t,s)}cleanNode(e,t,s=!0){if(r.default.isForbiddenNode(e))return!1;if(e.shadowRoot&&this.filterShadowRoot(e.shadowRoot,t,s),e.childNodes.length>0)for(let i=0;i<e.childNodes.length;i++)this.cleanNode(e.childNodes[i],t,s);else this.cleanChildNode(e,this.wordlistId,s)}cleanPage(){this.cfg=new d.default(p),this.domain=o.default.byHostname(this.hostname,this.cfg.domains),this.cfg.muteMethod=i.default.MuteMethods.Video;const e={disabled:this.cfg.enabledDomainsOnly&&!this.domain.enabled||this.domain.disabled};if(e.disabled)return h.runtime.sendMessage(e),!1;void 0!==this.domain.wordlistId&&(this.wordlistId=this.domain.wordlistId),void 0!==this.domain.audioWordlistId&&(this.audioWordlistId=this.domain.audioWordlistId),this.cfg.muteAudio&&(this.audio=new n.default(this),this.mutePage=this.audio.supportedPage,this.mutePage&&this.cfg.wordlistsEnabled&&this.wordlistId!=this.audio.wordlistId&&(this.wordlists[this.audio.wordlistId]=new l.default(this.cfg,this.audio.wordlistId))),this.init(),this.audioOnly||this.processNode(document,this.wordlistId),this.startObserving(document)}cleanText(e,t,s=!0){if(r.default.isForbiddenNode(e))return!1;if(e.shadowRoot&&this.filterShadowRoot(e.shadowRoot,t,s),e.childElementCount>0){const i=document.createTreeWalker(e,NodeFilter.SHOW_TEXT);for(;i.nextNode();)i.currentNode.childNodes.length>0?i.currentNode.childNodes.forEach((e=>{this.cleanText(e,t,s)})):r.default.isForbiddenNode(i.currentNode)||this.cleanChildNode(i.currentNode,t,s)}else this.cleanChildNode(e,t,s)}filterShadowRoot(e,t,s=!0){this.shadowObserver.observe(e,b),this.processNode(e,t,s)}init(e=!1){super.init(e),this.domain.advanced?this.processNode=this.advancedReplaceText:this.domain.deep?(this.processMutationTarget=!0,this.processNode=this.cleanNode):this.processNode=this.cleanText}processMutations(e){e.forEach((e=>{f.checkMutationForProfanity(e)}))}startObserving(e=document,t=this.observer){t.observe(e,b)}stopObserving(e=this.observer){const t=e.takeRecords();e.disconnect(),t&&this.processMutations(t)}updateCounterBadge(){}}const f=new m,b={characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0};if("undefined"!=typeof window){if(f.observer=new MutationObserver(f.processMutations),f.shadowObserver=new MutationObserver(f.processMutations),window!=window.top){f.iframe=document.location;try{f.hostname=window.parent.location.hostname}catch(e){document.referrer?f.hostname=new URL(document.referrer).hostname:f.hostname=document.location.hostname}}else f.hostname=document.location.hostname;f.cleanPage()}},50:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,o=(i=s(357))&&i.__esModule?i:{default:i};function a(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class r{static byHostname(e,t){const s=r.findDomainKey(e,t)||e,i=r.byKey(s,t);return i.hostname=e,i}static byKey(e,t){return new r(e,t[e])}static findDomainKey(e,t){return Object.keys(t).sort(((e,t)=>t.length-e.length)).find((t=>new RegExp(`(^|.)${t}$`).test(e)))}static getCurrentTab(){return new Promise(((e,t)=>{chrome.tabs.query({active:!0,currentWindow:!0},(t=>{e(t[0])}))}))}static sortedKeys(e){return Object.keys(e).sort(((e,t)=>{const s=e.match(/\w*\.\w*$/)[0],i=t.match(/\w*\.\w*$/)[0];return s<i?-1:s>i?1:0}))}constructor(e,t){a(this,"advanced",void 0),a(this,"audioWordlistId",void 0),a(this,"cfg",void 0),a(this,"cfgKey",void 0),a(this,"deep",void 0),a(this,"disabled",void 0),a(this,"enabled",void 0),a(this,"hostname",void 0),a(this,"tab",void 0),a(this,"wordlistId",void 0),this.cfgKey=e,this.cfg={},t?this.cfg=t:Object.assign(this.cfg,r._domainCfgDefaults),this.updateFromCfg()}getModeIndex(){return this.advanced?o.default.DomainModes.Advanced:this.deep?o.default.DomainModes.Deep:o.default.DomainModes.Normal}async save(e){if(e.domains)return this.updateCfg(),"{}"===JSON.stringify(this.cfg)?delete e.domains[this.cfgKey]:e.domains[this.cfgKey]=this.cfg,await e.save("domains")}updateCfg(){this.cfg.adv=!0===this.advanced||void 0,this.cfg.deep=!0===this.deep||void 0,this.cfg.disabled=!0===this.disabled||void 0,this.cfg.enabled=!0===this.enabled||void 0,this.cfg.wordlist=this.wordlistId>=0?this.wordlistId:void 0,this.cfg.audioList=this.audioWordlistId>=0?this.audioWordlistId:void 0}updateFromCfg(){this.advanced=this.cfg.adv,this.deep=this.cfg.deep,this.disabled=this.cfg.disabled,this.enabled=this.cfg.enabled,this.wordlistId=this.cfg.wordlist,this.audioWordlistId=this.cfg.audioList}updateFromModeIndex(e){switch(e){case o.default.DomainModes.Normal:this.advanced=!1,this.deep=!1;break;case o.default.DomainModes.Advanced:this.advanced=!0,this.deep=!1;break;case o.default.DomainModes.Deep:this.advanced=!1,this.deep=!0}}}t.default=r,a(r,"_domainCfgDefaults",{adv:void 0,audioList:void 0,deep:void 0,disabled:void 0,enabled:void 0,wordlist:void 0})},513:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,o=(i=s(357))&&i.__esModule?i:{default:i};function a(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class r{constructor(e={}){a(this,"censorCharacter",void 0),a(this,"censorFixedLength",void 0),a(this,"defaultSubstitution",void 0),a(this,"defaultWordMatchMethod",void 0),a(this,"defaultWordRepeat",void 0),a(this,"defaultWordSeparators",void 0),a(this,"filterMethod",void 0),a(this,"filterWordList",void 0),a(this,"iWordWhitelist",void 0),a(this,"preserveCase",void 0),a(this,"preserveFirst",void 0),a(this,"preserveLast",void 0),a(this,"showCounter",void 0),a(this,"showSummary",void 0),a(this,"substitutionMark",void 0),a(this,"wordlistId",void 0),a(this,"wordlists",void 0),a(this,"wordlistsEnabled",void 0),a(this,"words",void 0),a(this,"wordWhitelist",void 0),Object.assign(this,r._defaults,e)}addWord(e,t=this.defaultWordOptions()){return e=e.trim(),(t=Object.assign({},this.defaultWordOptions(),t)).matchMethod!==o.default.MatchMethods.Regex&&(e=e.toLowerCase()),!Object.keys(this.words).includes(e)&&(t.sub=t.sub.trim().toLowerCase(),this.words[e]=t,!0)}defaultWordOptions(){return{lists:[],matchMethod:this.defaultWordMatchMethod,repeat:this.defaultWordRepeat,separators:this.defaultWordSeparators,sub:""}}removeWord(e){const t=(e=e.trim()).toLowerCase();return Object.keys(this.words).includes(t)?(delete this.words[t],!0):!!this.words[e]&&(delete this.words[e],!0)}repeatForWord(e){return!0===this.words[e].repeat||!1===this.words[e].repeat?this.words[e].repeat:this.defaultWordRepeat}sanitizeWords(){const e={};Object.keys(this.words).sort().forEach((t=>{e[t.trim().toLowerCase()]=this.words[t]})),this.words=e}}t.default=r,a(r,"_allWordlists",["All words"]),a(r,"_defaults",{censorCharacter:"*",censorFixedLength:0,defaultSubstitution:"censored",defaultWordMatchMethod:o.default.MatchMethods.Exact,defaultWordRepeat:!1,defaultWordSeparators:!1,filterMethod:o.default.FilterMethods.Substitute,filterWordList:!0,iWordWhitelist:[],preserveCase:!0,preserveFirst:!0,preserveLast:!1,showCounter:!0,showSummary:!0,substitutionMark:!1,wordlistId:0,wordlists:["Wordlist 1","Wordlist 2","Wordlist 3","Wordlist 4","Wordlist 5","Wordlist 6"],wordlistsEnabled:!0,wordWhitelist:[]}),a(r,"_defaultWords",{ass:{lists:[],matchMethod:o.default.MatchMethods.Exact,repeat:!0,separators:!1,sub:"butt"},asses:{lists:[],matchMethod:o.default.MatchMethods.Exact,repeat:!1,separators:!1,sub:"butts"},asshole:{lists:[],matchMethod:o.default.MatchMethods.Partial,repeat:!0,separators:!1,sub:"jerk"},badass:{lists:[],matchMethod:o.default.MatchMethods.Partial,repeat:!0,separators:!0,sub:"cool"},bastard:{lists:[],matchMethod:o.default.MatchMethods.Partial,repeat:!0,separators:!1,sub:"idiot"},bitch:{lists:[],matchMethod:o.default.MatchMethods.Partial,repeat:!0,separators:!1,sub:"bench"},cocksucker:{lists:[],matchMethod:o.default.MatchMethods.Partial,repeat:!0,separators:!0,sub:"suckup"},cunt:{lists:[],matchMethod:o.default.MatchMethods.Partial,repeat:!0,separators:!1,sub:"expletive"},dammit:{lists:[],matchMethod:o.default.MatchMethods.Partial,repeat:!1,separators:!0,sub:"dangit"},damn:{lists:[],matchMethod:o.default.MatchMethods.Partial,repeat:!1,separators:!1,sub:"dang"},dumbass:{lists:[],matchMethod:o.default.MatchMethods.Partial,repeat:!0,separators:!1,sub:"idiot"},fag:{lists:[],matchMethod:o.default.MatchMethods.Exact,repeat:!0,separators:!1,sub:"gay"},faggot:{lists:[],matchMethod:o.default.MatchMethods.Partial,repeat:!0,separators:!1,sub:"gay"},fags:{lists:[],matchMethod:o.default.MatchMethods.Exact,repeat:!0,separators:!1,sub:"gays"},fuck:{lists:[],matchMethod:o.default.MatchMethods.Partial,repeat:!0,separators:!0,sub:"freak"},goddammit:{lists:[],matchMethod:o.default.MatchMethods.Partial,repeat:!0,separators:!0,sub:"dangit"},hell:{lists:[],matchMethod:o.default.MatchMethods.Exact,repeat:!1,separators:!1,sub:"heck"},jackass:{lists:[],matchMethod:o.default.MatchMethods.Partial,repeat:!0,separators:!0,sub:"jerk"},nigga:{lists:[],matchMethod:o.default.MatchMethods.Exact,repeat:!0,separators:!1,sub:"bruh"},nigger:{lists:[],matchMethod:o.default.MatchMethods.Exact,repeat:!0,separators:!1,sub:"man"},niggers:{lists:[],matchMethod:o.default.MatchMethods.Exact,repeat:!0,separators:!1,sub:"people"},piss:{lists:[],matchMethod:o.default.MatchMethods.Partial,repeat:!0,separators:!1,sub:"pee"},pissed:{lists:[],matchMethod:o.default.MatchMethods.Partial,repeat:!0,separators:!1,sub:"ticked"},pussies:{lists:[],matchMethod:o.default.MatchMethods.Exact,repeat:!0,separators:!1,sub:"softies"},pussy:{lists:[],matchMethod:o.default.MatchMethods.Exact,repeat:!0,separators:!1,sub:"softie"},shit:{lists:[],matchMethod:o.default.MatchMethods.Partial,repeat:!0,separators:!1,sub:"crap"},slut:{lists:[],matchMethod:o.default.MatchMethods.Partial,repeat:!0,separators:!1,sub:"tramp"},tits:{lists:[],matchMethod:o.default.MatchMethods.Partial,repeat:!0,separators:!1,sub:"chest"},twat:{lists:[],matchMethod:o.default.MatchMethods.Exact,repeat:!0,separators:!1,sub:"dumbo"},twats:{lists:[],matchMethod:o.default.MatchMethods.Exact,repeat:!0,separators:!1,sub:"dumbos"},whore:{lists:[],matchMethod:o.default.MatchMethods.Partial,repeat:!0,separators:!1,sub:"tramp"}})},357:(e,t)=>{"use strict";function s(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;class i{static filterMethodName(e){return this.nameById(this.FilterMethods,e)}static matchMethodName(e){return this.nameById(this.MatchMethods,e)}static nameById(e,t){return Object.entries(e).filter((e=>e[1]===t))[0][0]}static orderedArray(e){const t=[];return Object.values(e).sort().forEach((s=>{t.push(i.nameById(e,s))})),t}}t.default=i,s(i,"DomainModes",{Normal:0,Advanced:1,Deep:2}),s(i,"FilterMethods",{Censor:0,Substitute:1,Remove:2}),s(i,"MatchMethods",{Exact:0,Partial:1,Whole:2,Regex:3}),s(i,"MuteMethods",{Tab:0,Video:1,None:2}),s(i,"ShowSubtitles",{All:0,Filtered:1,Unfiltered:2,None:3})},394:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(s(357)),o=r(s(812)),a=r(s(709));function r(e){return e&&e.__esModule?e:{default:e}}function n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}t.default=class{constructor(){n(this,"cfg",void 0),n(this,"counter",void 0),n(this,"iWhitelist",void 0),n(this,"whitelist",void 0),n(this,"wordlistId",void 0),n(this,"wordlists",void 0),this.counter=0,this.iWhitelist=[],this.whitelist=[],this.wordlists={}}buildWordlist(e,t=!1){return!1===e&&(e=this.wordlistId),!t&&this.wordlists[e]||(this.wordlists[e]=new a.default(this.cfg,e)),e}checkWhitelist(e,t,s,a){const r=this.whitelist.length,n=this.iWhitelist.length;if(r||n){if(r&&this.whitelist.includes(e))return!0;if(n&&this.iWhitelist.includes(e.toLowerCase()))return!0;if(a.matchMethod===i.default.MatchMethods.Partial){const a={matchMethod:i.default.MatchMethods.Whole,repeat:!1,separators:!1,sub:""},d=new o.default(e,a,this.cfg).regExp;let l;for(;null!==(l=d.exec(t));){const t=4==l.length?l[2]:l[0],i=4==l.length?l.index+l[1].length:l.index;if(i<=s&&i+t.length>=s+e.length){if(r&&this.whitelist.includes(t))return!0;if(n&&this.iWhitelist.includes(t.toLowerCase()))return!0}}}}return!1}foundMatch(e){this.counter++}init(e=!1){this.iWhitelist=this.cfg.iWordWhitelist,this.whitelist=this.cfg.wordWhitelist,void 0===this.wordlistId&&(this.wordlistId=null==this.cfg.wordlistId?0:this.cfg.wordlistId),this.buildWordlist(e)}matchData(e,t,s,o){const a=e.find(t),r=o.pop(),n=o.pop(),d=o,l=d.length>0&&a.matchMethod!==i.default.MatchMethods.Regex;return l&&(s=d[1]),{word:a,string:r,match:s,matchStartIndex:n,captureGroups:d,internalCaptureGroups:l}}rebuildWordlists(){Object.keys(this.wordlists).forEach((e=>{this.buildWordlist(parseInt(e),!0)}))}replaceText(e,t=!1,s=!0){t=this.buildWordlist(t);const a=this.wordlists[t];switch(this.cfg.filterMethod){case i.default.FilterMethods.Censor:a.regExps.forEach(((t,i)=>{e=e.replace(t,((e,...t)=>{const{word:o,string:r,match:n,matchStartIndex:d,captureGroups:l,internalCaptureGroups:u}=this.matchData(a,i,e,t);if(this.checkWhitelist(n,r,d,o))return n;s&&this.foundMatch(o);let c="";const h=this.cfg.censorFixedLength>0?this.cfg.censorFixedLength:n.length;return c=this.cfg.preserveFirst&&this.cfg.preserveLast?n[0]+this.cfg.censorCharacter.repeat(h-2)+n.slice(-1):this.cfg.preserveFirst?n[0]+this.cfg.censorCharacter.repeat(h-1):this.cfg.preserveLast?this.cfg.censorCharacter.repeat(h-1)+n.slice(-1):this.cfg.censorCharacter.repeat(h),u&&(c=l[0]+c+l[2]),c}))}));break;case i.default.FilterMethods.Substitute:a.regExps.forEach(((t,i)=>{e=e.replace(t,((e,...t)=>{const{word:r,string:n,match:d,matchStartIndex:l,captureGroups:u,internalCaptureGroups:c}=this.matchData(a,i,e,t);if(this.checkWhitelist(d,n,l,r))return d;s&&this.foundMatch(r);let h=r.sub||this.cfg.defaultSubstitution;return this.cfg.preserveCase&&(o.default.allUpperCase(d)?h=h.toUpperCase():o.default.capitalized(d)&&(h=o.default.capitalize(h))),this.cfg.substitutionMark&&(h="["+h+"]"),c&&(h=u[0]+h+u[2]),h}))}));break;case i.default.FilterMethods.Remove:a.regExps.forEach(((t,i)=>{e=e.replace(t,((e,...t)=>{const{word:r,string:n,match:d,matchStartIndex:l,captureGroups:u,internalCaptureGroups:c}=this.matchData(a,i,e,t);return this.checkWhitelist(d.trim(),n,l,r)?d:(s&&this.foundMatch(r),c?o.default.whitespaceRegExp.test(u[0])&&o.default.whitespaceRegExp.test(u[2])?u[0]:o.default.nonWordRegExp.test(u[0])||o.default.nonWordRegExp.test(u[2])?(u[0]+u[2]).trim():"":o.default.whitespaceRegExp.test(d[0])&&o.default.whitespaceRegExp.test(d[d.length-1])?d[0]:"")}))}))}return e}replaceTextResult(e,t=!1,s=!0){const i={original:e,filtered:this.replaceText(e,t,s),modified:!1};return i.modified=i.filtered!=e,i}}},582:(e,t)=>{"use strict";function s(e){if(e.hasChildNodes)for(;e.firstChild;)e.firstChild.remove()}Object.defineProperty(t,"__esModule",{value:!0}),t.dynamicList=function(e,t,i){s(t);(void 0!==i?[i].concat(e):e).forEach((e=>{const s=document.createElement("option");s.value=i&&e===i?"":e,s.textContent=e,t.appendChild(s)}))},t.escapeHTML=function(e){return e.replace(/([<>&"'])/g,((e,t)=>({"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&apos;"}[t])))},t.exportToFile=function(e,t="data.txt"){const s="data:application/json;charset=utf-8,"+encodeURIComponent(e),i=document.createElement("a");i.setAttribute("href",s),i.setAttribute("download",t),i.click(),i.remove()},t.formatNumber=function(e){const t=e.toString().length;if(t<=3)return e.toString();if(t<=6){const t=(e/1e3).toPrecision(),s=t.indexOf(".");return(s>=-1&&s<=1?t.substr(0,3):t.substr(0,s))+"k"}if(t<=9){const t=(e/1e6).toPrecision(),s=t.indexOf(".");return(s>=-1&&s<=1?t.substr(0,3):t.substr(0,s))+"M"}return"1G+"},t.getGlobalVariable=function(e,t="APFData"){const s=document.createElement("script");s.id=t,s.textContent=`document.getElementById("${t}").textContent = JSON.stringify(${e})`,document.documentElement.appendChild(s);const i=document.querySelector(`script#${t}`).textContent;return s.remove(),JSON.parse(i)},t.getVersion=function(e){const t=e.split(".");return{major:parseInt(t[0]),minor:parseInt(t[1]),patch:parseInt(t[2])}},t.hmsToSeconds=function(e,t=3){const[s="0",i="0",o="0"]=(e||"0:0:0").split(":"),a=parseInt(s,10)||0,r=parseInt(i,10)||0,n=parseFloat(o)||0;return parseFloat((3600*a+60*r+n).toFixed(t))},t.injectScript=function(e,t,s=""){const i=document.getElementsByTagName(t)[0],o=document.createElement("script");o.setAttribute("type","text/javascript"),s&&(o.id=s);o.setAttribute("src",e),i.appendChild(o)},t.isVersionOlder=function(e,t){if(e.major<t.major)return!0;if(e.major==t.major&&e.minor<t.minor)return!0;if(e.major==t.major&&e.minor==t.minor&&e.patch<t.patch)return!0;return!1},t.makeRequest=function(e,t){return new Promise(((s,i)=>{const o=new XMLHttpRequest;o.open(e,t),o.onload=()=>{this.status>=200&&this.status<300?s(o.response):i({status:this.status,statusText:o.statusText})},o.onerror=()=>{i({status:this.status,statusText:o.statusText})},o.send()}))},t.readFile=function(e){return new Promise(((t,s)=>{const i=new FileReader;i.onload=()=>{t(i.result)},i.readAsText(e)}))},t.removeChildren=s,t.removeFromArray=function(e,t){return e.filter((e=>e!==t))},t.secondsToHMS=function(e){return new Date(1e3*e).toISOString().substr(11,12)}},812:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,o=(i=s(357))&&i.__esModule?i:{default:i};function a(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class r{static allLowerCase(e){return e.toLowerCase()===e}static allUpperCase(e){return e.toUpperCase()===e}static capitalize(e){return e.charAt(0).toUpperCase()+e.substr(1)}static capitalized(e){return e.charAt(0).toUpperCase()===e.charAt(0)}static containsDoubleByte(e){return!!e.length&&(e.charCodeAt(0)>127||r._unicodeRegExp.test(e))}static escapeRegExp(e){return e.replace(r._escapeRegExp,"\\$&")}constructor(e,t,s){a(this,"_filterMethod",void 0),a(this,"escaped",void 0),a(this,"lists",void 0),a(this,"matchMethod",void 0),a(this,"matchRepeated",void 0),a(this,"matchSeparators",void 0),a(this,"regExp",void 0),a(this,"sub",void 0),a(this,"unicode",void 0),a(this,"value",void 0),this.value=e,this.lists=void 0===t.lists?[]:t.lists,this.matchMethod=void 0===t.matchMethod?s.defaultWordMatchMethod:t.matchMethod,this.matchRepeated=void 0===t.repeat?s.defaultWordRepeat:t.repeat,this.matchSeparators=void 0===t.separators?s.defaultWordSeparators:t.separators,this.sub=void 0===t.sub?s.defaultSubstitution:t.sub,this._filterMethod=void 0===t._filterMethod?s.filterMethod:t._filterMethod,this.unicode=r.containsDoubleByte(e),this.escaped=this.matchMethod===o.default.MatchMethods.Regex?this.value:r.escapeRegExp(this.value),this.regExp=this.buildRegExp()}buildRegExp(){try{switch(this.matchMethod){case o.default.MatchMethods.Partial:return this._filterMethod===o.default.FilterMethods.Remove?this.unicode?new RegExp("(^|"+r._unicodeWordBoundary+"?)([\\w-]*"+this.processedPhrase()+"[\\w-]*)("+r._unicodeWordBoundary+"?|$)",this.regexOptions()):this.hasEdgePunctuation()?new RegExp("(^|\\s)([\\w-]*"+this.processedPhrase()+"[\\w-]*)(\\s|$)",this.regexOptions()):new RegExp("\\s?\\b[\\w-]*"+this.processedPhrase()+"[\\w-]*\\b\\s?",this.regexOptions()):new RegExp(this.processedPhrase(),this.regexOptions());case o.default.MatchMethods.Whole:return this.unicode?new RegExp("(^|"+r._unicodeWordBoundary+"*)([\\S]*"+this.processedPhrase()+"[\\S]*)("+r._unicodeWordBoundary+"*|$)",this.regexOptions()):this.hasEdgePunctuation()?new RegExp("(^|\\s)([\\S]*"+this.processedPhrase()+"[\\S]*)(\\s|$)",this.regexOptions()):new RegExp("\\b[\\w-]*"+this.processedPhrase()+"[\\w-]*\\b",this.regexOptions());case o.default.MatchMethods.Regex:return new RegExp(this.value,this.regexOptions());case o.default.MatchMethods.Exact:default:return this._filterMethod===o.default.FilterMethods.Remove?this.unicode?new RegExp("(^|"+r._unicodeWordBoundary+")("+this.processedPhrase()+")("+r._unicodeWordBoundary+"|$)",this.regexOptions()):this.hasEdgePunctuation()?new RegExp("(^|\\s)("+this.processedPhrase()+")(\\s|$)",this.regexOptions()):new RegExp("\\s?\\b"+this.processedPhrase()+"\\b\\s?",this.regexOptions()):this.unicode?new RegExp("(^|"+r._unicodeWordBoundary+"+)("+this.processedPhrase()+")("+r._unicodeWordBoundary+"+|$)",this.regexOptions()):this.hasEdgePunctuation()?new RegExp("(^|\\s)("+this.processedPhrase()+")(\\s|$)",this.regexOptions()):new RegExp("\\b"+this.processedPhrase()+"\\b",this.regexOptions())}}catch(e){throw new Error('Failed to create RegExp for "'+this.value+'" - '+e.name+" "+e.message)}}hasEdgePunctuation(){return r._edgePunctuationRegExp.test(this.value)}processedPhrase(){const e=this.escaped.includes("\\");let t="";const s=this.escaped.length-1;for(let i=0;i<this.escaped.length;i++)e&&"\\"===this.escaped[i]&&(t+=this.escaped[i],i++),t+=this.escaped[i],this.matchRepeated&&(t+="+"),this.matchSeparators&&i!=s&&(t+=r.separatorsRegExp);return t}regexOptions(){let e="gi";return this.unicode&&(e+="u"),e}}t.default=r,a(r,"_edgePunctuationRegExp",/(^[,.'"!?%$]|[,.'"!?%$]$)/),a(r,"_escapeRegExp",/[\/\\^$*+?.()|[\]{}]/g),a(r,"_unicodeRegExp",/[^\u0000-\u00ff]/),a(r,"_unicodeWordBoundary","[\\s.,'\"+!?|-]"),a(r,"nonWordRegExp",new RegExp("^\\s*[^\\w]+\\s*$","g")),a(r,"separatorsRegExp","[-_ ]*"),a(r,"whitespaceRegExp",/^\s+$/)},709:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,o=(i=s(812))&&i.__esModule?i:{default:i};function a(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}t.default=class{constructor(e,t){a(this,"all",void 0),a(this,"list",void 0),a(this,"regExps",void 0),this.all=[],this.list=[],this.regExps=[];Object.keys(e.words).sort(((e,t)=>t.length-e.length)).forEach((s=>{if(0===t||!Array.isArray(e.words[s].lists)||e.words[s].lists.includes(t))try{const t=new o.default(s,e.words[s],e);this.list.push(s),this.all.push(t),this.regExps.push(t.regExp)}catch(e){console.error(`APF: Failed to add word: '${s}'`)}}))}find(e){return"string"==typeof e?this.all[this.list.indexOf(e)]:"number"==typeof e?this.all[e]:void 0}}},470:(e,t)=>{"use strict";function s(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;class i{constructor(){s(this,"xpathDocText",void 0),s(this,"xpathNodeText",void 0)}static isForbiddenNode(e){return!!e.isContentEditable||(!(!e.parentNode||!e.parentNode.isContentEditable&&!i.forbiddenTags.includes(e.parentNode.nodeName))||i.forbiddenTags.includes(e.nodeName))}}t.default=i,s(i,"disabledProtocols",new RegExp("(^chrome:|^about:|^[a-zA-Z]+-extension:)","i")),s(i,"forbiddenNodeRegExp",new RegExp("^s*(<[a-z].+?/?>|{.+?:.+?;.*}|https?://[^s]+$)")),s(i,"forbiddenTags",["SCRIPT","STYLE","INPUT","TEXTAREA","IFRAME","LINK"])},210:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(s(357)),o=r(s(502)),a=s(582);function r(e){return e&&e.__esModule?e:{default:e}}function n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class d{constructor(e){if(n(this,"cueRuleIds",void 0),n(this,"enabledRuleIds",void 0),n(this,"fetching",void 0),n(this,"filter",void 0),n(this,"lastFilteredNode",void 0),n(this,"lastFilteredText",void 0),n(this,"lastProcessedText",void 0),n(this,"muted",void 0),n(this,"rules",void 0),n(this,"sites",void 0),n(this,"supportedPage",void 0),n(this,"unmuteTimeout",void 0),n(this,"volume",void 0),n(this,"watcherRuleIds",void 0),n(this,"wordlistId",void 0),n(this,"youTube",void 0),n(this,"youTubeAutoSubsMax",void 0),n(this,"youTubeAutoSubsMin",void 0),n(this,"youTubeAutoSubsTimeout",void 0),n(this,"youTubeAutoSubsUnmuteDelay",void 0),this.cueRuleIds=[],this.enabledRuleIds=[],this.watcherRuleIds=[],this.filter=e,this.lastFilteredNode=null,this.lastFilteredText="",this.lastProcessedText="",this.muted=!1,e.cfg.customAudioSites&&"object"==typeof e.cfg.customAudioSites||(e.cfg.customAudioSites={}),this.sites=o.default.combineSites(e.cfg.customAudioSites),this.volume=1,this.wordlistId=e.audioWordlistId,this.youTubeAutoSubsMax=1e3*e.cfg.youTubeAutoSubsMax,this.youTubeAutoSubsMin=e.cfg.youTubeAutoSubsMin,this.youTubeAutoSubsUnmuteDelay=0,this.rules=this.sites[e.hostname],this.rules&&(Array.isArray(this.rules)||(this.rules=[this.rules]),this.initRules(),this.enabledRuleIds.length>0)){if(this.supportedPage=!0,["m.youtube.com","tv.youtube.com","www.youtube.com"].includes(e.hostname)){this.youTube=!0;const e="[ __ ]",t={lists:0==this.wordlistId?[]:[this.wordlistId],matchMethod:i.default.MatchMethods.Partial,repeat:!1,separators:!1,sub:""};this.filter.cfg.addWord(e,t)}this.watcherRuleIds.length>0&&this.watcherRuleIds.forEach((e=>{setInterval(this.watcher,this.rules[e].checkInterval,this,e)})),this.cueRuleIds.length>0&&setInterval(this.watchForVideo,250,this)}}clean(e,t=0){const s=this.rules[t];if("watcher"===s.mode)return;let o=!1;e.nodeName&&"#text"===e.nodeName&&e.parentElement&&(e=e.parentElement);const a=s.subtitleSelector&&e.querySelectorAll?e.querySelectorAll(s.subtitleSelector):[e];if(0!==a.length)switch(a.forEach((e=>{const t="#text"===e.nodeName?"textContent":"innerText";!0===s.convertBreaks&&"#text"!==e.nodeName&&!d.brTagRegExp.test(e[t])&&d.brTagRegExp.test(e.innerHTML)&&("pre"!==e.style.whiteSpace&&(e.style.whiteSpace="pre"),e.textContent=e.innerHTML.replace(d.brTagRegExp,"\n"));const i=this.replaceTextResult(e[t]);i.modified&&(o=!0,this.mute(s),s.filterSubtitles&&(s.preserveWhiteSpace&&"pre"!==e.style.whiteSpace&&(e.style.whiteSpace="pre"),s.ignoreMutations&&this.filter.stopObserving(),e[t]=i.filtered,s.ignoreMutations&&this.filter.startObserving()),this.lastFilteredNode=e,this.lastFilteredText=e[t])})),s.showSubtitles){case i.default.ShowSubtitles.Filtered:o?this.showSubtitles(s,a):this.hideSubtitles(s,a);break;case i.default.ShowSubtitles.Unfiltered:o?this.hideSubtitles(s,a):this.showSubtitles(s,a);break;case i.default.ShowSubtitles.None:this.hideSubtitles(s,a)}}cleanYouTubeAutoSubs(e){null!=this.youTubeAutoSubsTimeout&&(clearTimeout(this.youTubeAutoSubsTimeout),this.youTubeAutoSubsTimeout=null);const t=this.replaceTextResult(e.textContent);if(t.modified)e.textContent=t.filtered,this.mute(),this.youTubeAutoSubsUnmuteDelay=null,this.filter.updateCounterBadge(),this.youTubeAutoSubsMax&&(this.youTubeAutoSubsTimeout=window.setTimeout(this.youTubeAutoSubsMuteTimeout,this.youTubeAutoSubsMax,this));else if(this.muted)if(this.youTubeAutoSubsMin>0){const e=document.getElementsByTagName(d.DefaultVideoSelector)[0].currentTime;null==this.youTubeAutoSubsUnmuteDelay?this.youTubeAutoSubsUnmuteDelay=e:(e<this.youTubeAutoSubsUnmuteDelay&&(this.youTubeAutoSubsUnmuteDelay=0),e>this.youTubeAutoSubsUnmuteDelay+this.youTubeAutoSubsMin&&this.unmute())}else this.unmute();if(this.filter.cfg.showSubtitles!==i.default.ShowSubtitles.All){const e=document.querySelector("div.ytp-caption-window-rollup span.captions-text");"block"==e.style.display&&(e.style.display="none")}}clearUnmuteTimeout(e){e.unmuteDelay&&null!=this.unmuteTimeout&&(clearTimeout(this.unmuteTimeout),this.unmuteTimeout=null)}delayedUnmute(e,t){e.unmute(t,null,!0),this.unmuteTimeout=null}getVideoTextTrack(e,t,s="videoCueLanguage"){if(e.textTracks&&e.textTracks.length>0){let i;switch(s){case"videoCueLanguage":i="language";break;case"videoCueLabel":case"externalSubTrackLabel":i="label"}for(let o=0;o<e.textTracks.length;o++)if(this.matchTextTrack(e.textTracks[o],t,i,s))return e.textTracks[o];if(e.textTracks[0]&&e.textTracks[0].cues.length)return e.textTracks[0]}}hideCue(e,t){(e.showSubtitles===i.default.ShowSubtitles.Filtered&&!t.filtered||e.showSubtitles===i.default.ShowSubtitles.Unfiltered&&t.filtered||e.showSubtitles===i.default.ShowSubtitles.None)&&(t.text="",t.position=100,t.size=0)}hideSubtitles(e,t){if(e.displaySelector){const s=e.rootNode&&t&&t[0]?t[0].getRootNode():document;if(s){const t=s.querySelector(e.displaySelector);t&&(""===e.displayShow&&""!==t.style.display&&t.style.display!==e.displayHide&&(e.displayShow=t.style.display),t.style.setProperty("display",e.displayHide))}}else t&&t.forEach((t=>{t.innerText="",e.removeSubtitleSpacing&&t.style&&(t.style.padding&&(t.style.padding=0),t.style.margin&&(t.style.margin=0))}))}initCueRule(e){void 0===e.videoSelector&&(e.videoSelector=d.DefaultVideoSelector),void 0===e.videoCueRequireShowing&&(e.videoCueRequireShowing=this.filter.cfg.muteCueRequireShowing),e.externalSub&&(void 0===e.externalSubURLKey&&(e.externalSubURLKey="url"),void 0===e.externalSubFormatKey&&(e.externalSubFormatKey="format"),void 0===e.externalSubTrackLabel&&(e.externalSubTrackLabel="APF"))}initDisplaySelector(e){void 0!==e.displaySelector&&(void 0===e.displayHide&&(e.displayHide="none"),void 0===e.displayShow&&(e.displayShow=""))}initElementChildRule(e){e.parentSelector||e.parentSelectorAll||(e.disabled=!0),this.initDisplaySelector(e)}initElementRule(e){this.initDisplaySelector(e)}initRules(){this.rules.forEach(((e,t)=>{if((void 0===e.mode||("element"==e.mode||"elementChild"==e.mode)&&!e.tagName||!0===e.iframe&&null==this.filter.iframe||!1===e.iframe&&null!=this.filter.iframe)&&(e.disabled=!0),!e.disabled){switch(null==e.filterSubtitles&&(e.filterSubtitles=!0),null==e.muteMethod&&(e.muteMethod=this.filter.cfg.muteMethod),null==e.showSubtitles&&(e.showSubtitles=this.filter.cfg.showSubtitles),null!=e.tagName&&"#text"!=e.tagName&&(e.tagName=e.tagName.toUpperCase()),e.mode){case"cue":this.initCueRule(e),e.disabled||this.cueRuleIds.push(t);break;case"elementChild":this.initElementChildRule(e);break;case"element":this.initElementRule(e);break;case"text":this.initTextRule(e);break;case"watcher":this.initWatcherRule(e),e.disabled||this.watcherRuleIds.push(t)}e.disabled||this.enabledRuleIds.push(t)}}))}initTextRule(e){e.tagName="#text",void 0===e.simpleUnmute&&(e.simpleUnmute=!0)}initWatcherRule(e){void 0===e.checkInterval&&(e.checkInterval=20),void 0===e.ignoreMutations&&(e.ignoreMutations=!0),void 0===e.simpleUnmute&&(e.simpleUnmute=!0),void 0===e.videoSelector&&(e.videoSelector=d.DefaultVideoSelector),this.initDisplaySelector(e)}matchTextTrack(e,t,s,i){if(e.cues.length>0&&(!t.videoCueRequireShowing||"showing"===e.mode))return!s||!i||!t[i]||e[s]==t[i]}mute(e,t){if(!this.muted){this.muted=!0;switch(e&&e.muteMethod>=0?e.muteMethod:this.filter.cfg.muteMethod){case i.default.MuteMethods.Tab:chrome.runtime.sendMessage({mute:!0});break;case i.default.MuteMethods.Video:t||(t=document.querySelector(e&&e.videoSelector?e.videoSelector:d.DefaultVideoSelector)),t&&null!=t.volume&&(this.volume=t.volume,t.volume=0)}}e&&e.unmuteDelay&&this.unmuteTimeout&&this.clearUnmuteTimeout(e)}newCue(e,t,s,i={}){try{const o=new VTTCue((0,a.hmsToSeconds)(e),(0,a.hmsToSeconds)(t),s);return i.align&&(o.align=i.align),i.line&&(o.line=this.parseLineAndPositionSetting(i.line)),i.position&&(o.position=this.parseLineAndPositionSetting(i.position)),o}catch(i){console.error(`APF: Failed to add cue: ( start: ${e}, end: ${t}, text: ${s} )`,i)}}newTextTrack(e,t,s){if(t.textTracks){const i=t.addTextTrack("captions",e.externalSubTrackLabel,e.videoCueLanguage);i.mode="showing";for(let e=0;e<s.length;e++)i.addCue(s[e]);return i}}parseLineAndPositionSetting(e){if("string"==typeof e&&""!=e)return"auto"==e?"auto":parseInt(e)}parseSRT(e){const t=e.trim().replace("\r\n","\n").split(/[\r\n]/).map((e=>e.trim())),s=[];let i=null,o=null,a=null;for(let e=0;e<t.length;e++)if(t[e].indexOf("--\x3e")>=0){const s=t[e].split(/[ \t]+-->[ \t]+/);if(2!=s.length)throw'Error when splitting "--\x3e": '+t[e];i=s[0],o=s[1]}else if(""==t[e]){if(i&&o){const e=this.newCue(i,o,a);s.push(e),i=null,o=null,a=null}}else i&&o&&(null==a?a=t[e]:a+="\n"+t[e]);if(i&&o){const e=this.newCue(i,o,a);s.push(e)}return s}parseSSA(e){const t=[];let s,i,o,a=!1;const r=e.split("\n");for(let e=0;e<r.length;e++)if(a){if(r[e].match(/^format:/i)){const t=r[e].trim().split(",");s=t.indexOf("End"),i=t.indexOf("Start"),o=t.indexOf("Text")}else if(r[e].match(/^dialogue:/i)){const a=r[e].trim().split(","),n=a[i],d=a[s],l=a.slice(o).join(",").replace(/\{\\\w.+?\}/g,"").split("\\N").reverse();for(let e=0;e<l.length;e++)t.push(this.newCue(n,d,l[e]))}}else r[e].match(/^\[Events\]/i)&&(a=!0);return t}parseVTT(e){const t=[],s=e.split("\n"),i=new RegExp("\\s--\x3e\\s");for(let e=0;e<s.length;e++){const o=s[e].trim();if(o.match(i)){const r=o.replace(i," ").split(" ");let[n,d,...l]=r;n=n.replace(",","."),d=d.replace(",",".");const u=l.map((e=>e.split(":"))).reduce(((e,t)=>(e[t[0]]=t[1],e)),{}),c=s[e-1].trim(),h=s[e+1].trim(),p=new RegExp(`^<[cs]\\.${c}>`),m=new RegExp("</[cs]>$");let f;if(f=h.match(p)?h.replace(p,"").replace(m,""):h,c&&!c.match(/_1$/)){const e=t[t.length-1];e.startTime!=(0,a.hmsToSeconds)(n)&&e.endTime==(0,a.hmsToSeconds)(d)&&(n=(0,a.secondsToHMS)(e.startTime))}const b=this.newCue(n,d,f,u);if(c&&!c.match(/_1$/)){const e=parseInt(c.match(/_([2-9])$/)[1]),s=t.length-e+1;t.splice(s,0,b)}else t.push(b);e++}}return t}playing(e){return!!(e&&e.currentTime>0&&!e.paused&&!e.ended&&e.readyState>2)}processCues(e,t){for(let s=0;s<e.length;s++){const i=e[s];if(i.hasOwnProperty("filtered"))continue;t.videoCueSync&&(i.startTime+=t.videoCueSync,i.endTime+=t.videoCueSync);const o=this.replaceTextResult(i.text);o.modified?(i.filtered=!0,i.originalText=i.text,i.text=o.filtered):i.filtered=!1,t.videoCueHideCues&&this.hideCue(t,i)}}async processExternalSub(e,t){const s=this.getVideoTextTrack(e,t,"externalSubTrackLabel");if(!this.fetching&&!s)try{const s=(0,a.getGlobalVariable)(t.externalSubVar);if(!Array.isArray(s))throw`Failed to find subtitle variable: ${t.externalSubVar}`;{const i=s.find((e=>e.language===t.videoCueLanguage));if(!i)throw`Failed to find subtitle for language: ${t.videoCueLanguage}.`;this.fetching=!0;const o=await(0,a.makeRequest)("GET",i[t.externalSubURLKey]);if("string"!=typeof o||!o)throw"Failed to download external subtitles.";{let s;switch(i[t.externalSubFormatKey]){case"ass":s=this.parseSSA(o);break;case"srt":s=this.parseSRT(o);break;case"vtt":s=this.parseVTT(o);break;default:throw`Unsupported subtitle type: ${i[t.externalSubFormatKey]}`}if(s){const i=this.newTextTrack(t,e,s).cues;if(this.processCues(i,t),this.fetching=!1,t.displaySelector){const e=document.querySelector(t.displaySelector);e&&(e.style.display="none")}}}}}catch(e){console.error("APF: Error using external subtitles. ",e)}}processWatcherCaptions(e,t,s){const i=s.initialCall;if(i){if(this.lastProcessedText&&this.lastProcessedText===t.textContent)return s.skipped=!0,!1;this.unmute(e),this.lastProcessedText="",s.initialCall=!1,s.filtered=!1}if(t.hasChildNodes())t.childNodes.forEach((t=>{this.processWatcherCaptions(e,t,s)}));else{const i="#text"===(t&&t.nodeName)?"textContent":"innerText";if(t[i]&&t[i].trim()){const o=this.replaceTextResult(t[i]);o.modified&&(this.mute(e),s.filtered=!0,e.filterSubtitles&&(t[i]=o.filtered))}}i&&(this.lastProcessedText=t.textContent)}replaceTextResult(e,t=!0){return this.filter.replaceTextResult(e,this.wordlistId,t)}showSubtitles(e,t){if(e.displaySelector){const s=e.rootNode&&t&&t[0]?t[0].getRootNode():document;if(s){const t=s.querySelector(e.displaySelector);t&&t.style.setProperty("display",e.displayShow)}}}supportedNode(e){for(let t=0;t<this.enabledRuleIds.length;t++){const s=this.enabledRuleIds[t],i=this.rules[s];switch(i.mode){case"element":if(e.nodeName==i.tagName){let t=!1;if(t||!i.className||e.className&&e.classList.contains(i.className)||(t=!0),t||!i.dataPropPresent||e.dataset&&e.dataset.hasOwnProperty(i.dataPropPresent)||(t=!0),t||!i.hasChildrenElements||"number"==typeof e.childElementCount&&0!=e.childElementCount||(t=!0),t||!i.subtitleSelector||"function"==typeof e.querySelector&&e.querySelector(i.subtitleSelector)||(t=!0),t||!i.containsSelector||"function"==typeof e.querySelector&&e.querySelector(i.containsSelector)||(t=!0),!t)return s}break;case"elementChild":if(e.nodeName===i.tagName){const t=i.rootNode?e.getRootNode():document;if(t)if(i.parentSelector){const o=t.querySelector(i.parentSelector);if(o&&o.contains(e))return s}else{const o=t.querySelectorAll(i.parentSelectorAll);for(let t=0;t<o.length;t++)if(o[t].contains(e))return s}}break;case"text":if(e.nodeName===i.tagName){const t=document.querySelector(i.parentSelector);if(t&&t.contains(e))return s}break;case"watcher":if(e.parentElement&&e.parentElement==document.querySelector(i.subtitleSelector))return s;if(null!=i.parentSelector){const t=document.querySelector(i.parentSelector);if(t&&t.contains(e))return s}}}return!1}unmute(e,t,s=!1){if(this.muted){if(!s&&e&&e.unmuteDelay>=0)return null==this.unmuteTimeout&&this.clearUnmuteTimeout(e),void(this.unmuteTimeout=window.setTimeout(this.delayedUnmute,e.unmuteDelay,this,e));this.muted=!1;switch(e&&e.muteMethod>=0?e.muteMethod:this.filter.cfg.muteMethod){case i.default.MuteMethods.Tab:chrome.runtime.sendMessage({mute:!1});break;case i.default.MuteMethods.Video:t||(t=document.querySelector(e&&e.videoSelector?e.videoSelector:d.DefaultVideoSelector)),t&&null!=t.volume&&(t.volume=this.volume)}}}watcher(e,t=0){const s=e.rules[t],o=document.querySelector(s.videoSelector);if(o&&e.playing(o)){s.ignoreMutations&&e.filter.stopObserving();const t=document.querySelector(s.subtitleSelector);if(t&&t.textContent&&t.textContent.trim()){const o={initialCall:!0};if(e.processWatcherCaptions(s,t,o),o.skipped)return!1;switch(s.showSubtitles){case i.default.ShowSubtitles.Filtered:o.filtered?e.showSubtitles(s):e.hideSubtitles(s);break;case i.default.ShowSubtitles.Unfiltered:o.filtered?e.hideSubtitles(s):e.showSubtitles(s);break;case i.default.ShowSubtitles.None:e.hideSubtitles(s)}o.filtered&&e.filter.updateCounterBadge()}else s.simpleUnmute&&(e.unmute(s,o),s.showSubtitles>0&&e.hideSubtitles(s))}else s.ignoreMutations&&e.filter.startObserving()}watchForVideo(e){for(let t=0;t<e.cueRuleIds.length;t++){const s=e.rules[t],o=document.querySelector(s.videoSelector);if(o&&o.textTracks&&e.playing(o)){s.externalSub&&e.processExternalSub(o,s);const t=s.externalSub?"externalSubTrackLabel":"videoCueLanguage",a=e.getVideoTextTrack(o,s,t);a&&!a.oncuechange&&(s.videoCueHideCues||s.showSubtitles!==i.default.ShowSubtitles.None||(a.mode="hidden"),a.oncuechange=()=>{if(a.activeCues&&a.activeCues.length>0){let t=!1;for(let i=0;i<a.activeCues.length;i++){const r=a.activeCues[i];if(!r.hasOwnProperty("filtered")){const t=a.cues;e.processCues(t,s)}r.filtered&&(t=!0,e.mute(s,o))}if(t||e.unmute(s,o),!s.videoCueHideCues)if(t)switch(s.showSubtitles){case i.default.ShowSubtitles.Filtered:a.mode="showing";break;case i.default.ShowSubtitles.Unfiltered:a.mode="hidden"}else switch(s.showSubtitles){case i.default.ShowSubtitles.Filtered:a.mode="hidden";break;case i.default.ShowSubtitles.Unfiltered:a.mode="showing"}}else e.unmute(s,o)})}}}youTubeAutoSubsCurrentRow(e){return!(e.parentElement.parentElement!=e.parentElement.parentElement.parentElement.lastChild)}youTubeAutoSubsMuteTimeout(e){const t=window.document.querySelector(d.DefaultVideoSelector);t&&e.playing(t)&&e.unmute(),e.youTubeAutoSubsTimeout=null}youTubeAutoSubsNodeIsSubtitleText(e){const t=document.querySelector("div.caption-window");return!(!t||!t.contains(e))}youTubeAutoSubsPresent(){return!!document.querySelector("div.ytp-caption-window-rollup")}youTubeAutoSubsSupportedNode(e){return"#text"==e.nodeName&&""!=e.textContent&&!!this.youTubeAutoSubsNodeIsSubtitleText(e)}}t.default=d,n(d,"brTagRegExp",new RegExp("<br>","i")),n(d,"DefaultVideoSelector","video")},502:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;class s{static combineSites(e={}){return Object.assign({},s.sites,e)}}var i,o,a;t.default=s,a={"abc.com":[{className:"akamai-caption-text",mode:"element",tagName:"DIV"}],"acorn.tv":[{iframe:!0,mode:"elementChild",parentSelector:"div.vjs-text-track-display",simpleUnmute:!0,subtitleSelector:":scope div > div",tagName:"DIV"}],"www.amazon.com":[{displayHide:"none",displaySelector:"div.webPlayerContainer div.f35bt6a",displayShow:"",iframe:!1,mode:"watcher",parentSelector:"div.webPlayerContainer div p > span",subtitleSelector:"div.webPlayerContainer div span > span",videoSelector:"div.webPlayerElement video[src]"}],"www.amc.com":[{className:"ttr-container",mode:"element",subtitleSelector:"span.ttr-cue",tagName:"DIV"},{mode:"cue",videoCueLanguage:"en",videoSelector:"video"}],"tv.apple.com":[{displaySelector:"div.video-container > div > div > div",mode:"elementChild",parentSelector:"div.video-container",preserveWhiteSpace:!0,rootNode:!0,subtitleSelector:"div > div > div > div > div",tagName:"DIV"}],"www.att.tv":[{mode:"cue",videoSelector:"video#quickplayPlayer"}],"www.attwatchtv.com":[{mode:"cue",videoSelector:"video#quickplayPlayer"}],"www.britbox.com":[{className:"bmpui-ui-subtitle-label",mode:"element",tagName:"SPAN"},{className:"bmpui-subtitle-region-container",mode:"element",subtitleSelector:"div.bmpui-container-wrapper > span.bmpui-ui-subtitle-label",tagName:"div"}],"gem.cbc.ca":[{className:"jw-text-track-container",mode:"element",subtitleSelector:"div.jw-text-track-cue",tagName:"DIV"}],"www.cbs.com":[{mode:"cue",videoCueLanguage:"en",videoCueRequireShowing:!1}],"www.crackle.com":[{ignoreMutations:!0,mode:"elementChild",parentSelector:"div.clpp-subtitles-container",simpleUnmute:!0,tagName:"#text"}],"www.criterionchannel.com":[{iframe:!0,mode:"cue",videoCueHideCues:!0,videoCueRequireShowing:!1}],"www.crunchyroll.com":[{displaySelector:"canvas#velocity-canvas",externalSub:!0,externalSubVar:"window.v1config.media.subtitles",iframe:!0,mode:"cue",showSubtitles:0,videoCueLanguage:"enUS",videoCueRequireShowing:!1}],"www.cwtv.com":[{className:"ttr-container",mode:"element",subtitleSelector:"span.ttr-cue",tagName:"DIV"}],"www.dishanywhere.com":[{className:"bmpui-ui-subtitle-label",mode:"element",tagName:"SPAN"},{className:"bmpui-subtitle-region-container",mode:"element",subtitleSelector:"div.bmpui-container-wrapper > span.bmpui-ui-subtitle-label",tagName:"div"}],"www.disneyplus.com":[{mode:"cue",videoSelector:"video.btm-media-client-element"}],"www.fox.com":[{className:"jw-text-track-container",mode:"element",subtitleSelector:"div.jw-text-track-cue",tagName:"DIV"}],"www.funimation.com":[{iframe:!0,mode:"elementChild",parentSelector:"div.vjs-text-track-display",simpleUnmute:!0,subtitleSelector:":scope div > div",tagName:"DIV"}],"play.google.com":[{className:"lava-timed-text-window",mode:"element",subtitleSelector:"span.lava-timed-text-caption",tagName:"DIV"}],"play.hbomax.com":[{mode:"elementChild",parentSelectorAll:"div.class3 > span, div.class28 > span",showSubtitles:0,tagName:"SPAN"}],"www.hulu.com":[{className:"caption-text-box",displaySelector:"div.caption-text-box",mode:"element",subtitleSelector:"p",tagName:"DIV"},{displaySelector:"div.CaptionBox",mode:"elementChild",parentSelector:"div.CaptionBox",tagName:"P"}],"www.nbc.com":[{className:"ttr-line",mode:"element",subtitleSelector:"span.ttr-cue",tagName:"DIV"},{mode:"cue",videoCueLanguage:"en"}],"www.netflix.com":[{className:"player-timedtext-text-container",mode:"element",subtitleSelector:"span",tagName:"DIV"}],"www.peacocktv.com":[{mode:"elementChild",parentSelector:"div.video-player__subtitles > div",subtitleSelector:"SPAN > SPAN",tagName:"div"}],"www.philo.com":[{mode:"cue"}],"app.plex.tv":[{dataPropPresent:"dialogueId",mode:"element",subtitleSelector:"span > span",tagName:"DIV"},{containsSelector:"div[data-dialogue-id]",mode:"element",subtitleSelector:"span > span",tagName:"DIV"}],"pluto.tv":[{mode:"cue",videoCueHideCues:!0,videoCueRequireShowing:!1}],"watch.redeemtv.com":[{convertBreaks:!0,displaySelector:"div.vp-captions",mode:"elementChild",parentSelector:"div.vp-captions",tagName:"SPAN"}],"www.showmax.com":[{ignoreMutations:!0,mode:"elementChild",parentSelector:"div.contentWrapper > div.subtitles--3EXhT",simpleUnmute:!0,tagName:"#text"}],"play.stan.com.au":[{ignoreMutations:!0,mode:"elementChild",parentSelector:"div.clpp-subtitles-container",simpleUnmute:!0,tagName:"#text"}],"www.starz.com":[{mode:"elementChild",parentSelector:"starz-captions > div.cue-list",tagName:"SPAN"}],"www.syfy.com":[{className:"ttr-line",mode:"element",subtitleSelector:"span.ttr-cue",tagName:"DIV"}],"www.tntdrama.com":[{mode:"cue",videoCueLanguage:"en",videoSelector:"video.top-media-element"}],"tubitv.com":[{mode:"elementChild",parentSelector:"div#captionsComponent",tagName:"SPAN"}],"www.universalkids.com":[{mode:"element",subtitleSelector:"div.gwt-HTML",tagName:"DIV"}],"www.usanetwork.com":[{className:"ttr-line",mode:"element",subtitleSelector:"span.ttr-cue",tagName:"DIV"}],"www.vudu.com":[{mode:"element",subtitleSelector:"span.subtitles",tagName:"DIV"}],"vrv.co":[{displaySelector:"div.libassjs-canvas-parent",externalSub:!0,externalSubVar:"window.vilos.content.captions",iframe:!0,mode:"cue",videoCueLanguage:"en-US",videoCueRequireShowing:!1},{displaySelector:"div.libassjs-canvas-parent",externalSub:!0,externalSubVar:"window.vilos.content.subtitles",iframe:!0,mode:"cue",videoCueLanguage:"en-US",videoCueRequireShowing:!1}],"m.youtube.com":[{className:"caption-window",mode:"element",subtitleSelector:"span.ytp-caption-segment",tagName:"DIV"}],"tv.youtube.com":[{className:"caption-window",mode:"element",subtitleSelector:"span.ytp-caption-segment",tagName:"DIV"}],"www.youtube.com":[{className:"caption-window",mode:"element",subtitleSelector:"span.ytp-caption-segment",tagName:"DIV"}]},(o="sites")in(i=s)?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a},863:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(s(357)),o=a(s(513));function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class n extends o.default{static async build(e=[]){"string"==typeof e&&(e=[e]);const t=await n.getConfig(e);return new n(t)}constructor(e){if(void 0===e)throw new Error("Cannot be called directly. call build()");super(),r(this,"_splitContainerKeys",void 0),r(this,"audioWordlistId",void 0),r(this,"customAudioSites",void 0),r(this,"darkMode",void 0),r(this,"domains",void 0),r(this,"enabledDomainsOnly",void 0),r(this,"muteAudio",void 0),r(this,"muteAudioOnly",void 0),r(this,"muteCueRequireShowing",void 0),r(this,"muteMethod",void 0),r(this,"password",void 0),r(this,"showSubtitles",void 0),r(this,"showUpdateNotification",void 0),r(this,"youTubeAutoSubsMax",void 0),r(this,"youTubeAutoSubsMin",void 0),this._splitContainerKeys={},Object.assign(this,n._classDefaults,e)}static combineData(e,t){if(e[t]={},void 0!==e[`_${t}0`]){const s=n.getDataContainerKeys(e,t);return s.forEach((s=>{Object.assign(e[t],e[s]),delete e[s]})),s}}static getConfig(e){return new Promise(((t,s)=>{let i=null;e.length>0&&!e.some((e=>n._splittingKeys.includes(e)))&&(i={},e.forEach((e=>{i[e]=n._defaults[e]}))),chrome.storage.sync.get(i,(s=>{s._splitContainerKeys={},Object.keys(n._defaults).forEach((t=>{null!=i&&!e.includes(t)||void 0!==s[t]||(s[t]=n._defaults[t])})),(0===e.length||e.includes("words"))&&(void 0!==s._words0&&0!=Object.keys(s._words0).length||(s._words0=o.default._defaultWords)),n._splittingKeys.forEach((e=>{const t=n.combineData(s,e);t&&(s._splitContainerKeys[e]=t)})),null!==i&&e.length>0&&Object.keys(s).forEach((t=>{e.includes(t)||delete s[t]})),t(s)}))}))}static getDataContainerKeys(e,t){const s=new RegExp(`^_${t}\\d+`);return Object.keys(e).filter((e=>s.test(e)))}ordered(){return Object.keys(this).sort().reduce(((e,t)=>("_"!=t[0]&&(e[t]=this[t]),e)),{})}remove(e){"string"==typeof e&&(e=[e]),chrome.storage.sync.remove(e),e.forEach((e=>{delete this[e]}))}reset(){return new Promise(((e,t)=>{chrome.storage.sync.clear((()=>{e(chrome.runtime.lastError?1:0)}))}))}save(e=[]){"string"==typeof e&&(e=[e]);const t={};return 0===e.length&&(e=Object.keys(n._defaults)).push("words"),e.forEach((e=>{n._splittingKeys.includes(e)?Object.assign(t,this.splitData(e)):t[e]=this[e]})),0!==Object.keys(this._splitContainerKeys).length&&e.some((e=>n._splittingKeys.includes(e)))&&n._splittingKeys.forEach((s=>{if(e.includes(s)){const e=n.getDataContainerKeys(t,s);if(this._splitContainerKeys[s]){const t=this._splitContainerKeys[s].filter((t=>!e.includes(t)));0!==t.length&&(this.remove(t),this._splitContainerKeys[s]=e)}}})),new Promise(((e,s)=>{chrome.storage.sync.set(t,(()=>{e(chrome.runtime.lastError?1:0)}))}))}splitData(e){const t=new TextEncoder;let s=0,i=2;const o={};let a=`_${e}${s}`;return o[a]={},i+=t.encode(`{"${a}":{}}`).length,Object.keys(this[e]).sort().forEach((r=>{let d=t.encode(`",${r}":`).length;d+=t.encode(JSON.stringify(this[e][r])).length,i+d>=n._maxBytes&&(s++,a=`_${e}${s}`,o[a]={},i=t.encode(`"${a}":{}`).length),i+=d,o[a][r]=this[e][r]})),o}}t.default=n,r(n,"_classDefaults",{domains:{},audioWordlistId:0,customAudioSites:null,darkMode:!1,enabledDomainsOnly:!1,muteAudio:!1,muteAudioOnly:!1,muteCueRequireShowing:!1,muteMethod:i.default.MuteMethods.Tab,password:null,showSubtitles:i.default.ShowSubtitles.All,showUpdateNotification:!0,youTubeAutoSubsMax:0,youTubeAutoSubsMin:0}),r(n,"QUOTA_BYTES_PER_ITEM",8192),r(n,"_defaults",Object.assign({},o.default._defaults,n._classDefaults)),r(n,"_splittingKeys",["domains","words"]),r(n,"_maxBytes",8e3)},894:function(){
// @license http://unlicense.org/UNLICENSE
"undefined"!=typeof window&&(window.findAndReplaceDOMText=function(){var e="retain",t="first",s=document,i={}.hasOwnProperty;function o(e){return String(e).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function a(){return r.apply(null,arguments)||n.apply(null,arguments)}function r(e,t,s,i,o){if(t&&!t.nodeType&&arguments.length<=2)return!1;var r,d="function"==typeof s;d&&(r=s,s=function(e,t){return r(e.text,t.startIndex)});var l=n(t,{find:e,wrap:d?null:s,replace:d?s:"$"+(i||"&"),prepMatch:function(e,t){if(!e[0])throw"findAndReplaceDOMText cannot handle zero-length matches";if(i>0){var s=e[i];e.index+=e[0].indexOf(s),e[0]=s}return e.endIndex=e.index+e[0].length,e.startIndex=e.index,e.index=t,e},filterElements:o});return a.revert=function(){return l.revert()},!0}function n(e,t){return new d(e,t)}function d(t,s){var o=s.preset&&a.PRESETS[s.preset];if(s.portionMode=s.portionMode||e,o)for(var r in o)i.call(o,r)&&!i.call(s,r)&&(s[r]=o[r]);this.node=t,this.options=s,this.prepMatch=s.prepMatch||this.prepMatch,this.reverts=[],this.matches=this.search(),this.matches.length&&this.processMatches()}return a.NON_PROSE_ELEMENTS={br:1,hr:1,script:1,style:1,img:1,video:1,audio:1,canvas:1,svg:1,map:1,object:1,input:1,textarea:1,select:1,option:1,optgroup:1,button:1},a.NON_CONTIGUOUS_PROSE_ELEMENTS={address:1,article:1,aside:1,blockquote:1,dd:1,div:1,dl:1,fieldset:1,figcaption:1,figure:1,footer:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,header:1,hgroup:1,hr:1,main:1,nav:1,noscript:1,ol:1,output:1,p:1,pre:1,section:1,ul:1,br:1,li:1,summary:1,dt:1,details:1,rp:1,rt:1,rtc:1,script:1,style:1,img:1,video:1,audio:1,canvas:1,svg:1,map:1,object:1,input:1,textarea:1,select:1,option:1,optgroup:1,button:1,table:1,tbody:1,thead:1,th:1,tr:1,td:1,caption:1,col:1,tfoot:1,colgroup:1},a.NON_INLINE_PROSE=function(e){return i.call(a.NON_CONTIGUOUS_PROSE_ELEMENTS,e.nodeName.toLowerCase())},a.PRESETS={prose:{forceContext:a.NON_INLINE_PROSE,filterElements:function(e){return!i.call(a.NON_PROSE_ELEMENTS,e.nodeName.toLowerCase())}}},a.Finder=d,d.prototype={search:function(){var e,t=0,s=0,i=this.options.find,a=this.getAggregateText(),r=[],n=this;function d(o){for(var a=0,l=o.length;a<l;++a){var u=o[a];if("string"==typeof u){if(i.global)for(;e=i.exec(u);)r.push(n.prepMatch(e,t++,s));else(e=u.match(i))&&r.push(n.prepMatch(e,0,s));s+=u.length}else d(u)}}return i="string"==typeof i?RegExp(o(i),"g"):i,d(a),r},prepMatch:function(e,t,s){if(!e[0])throw new Error("findAndReplaceDOMText cannot handle zero-length matches");return e.endIndex=s+e.index+e[0].length,e.startIndex=s+e.index,e.index=t,e},getAggregateText:function(){var e=this.options.filterElements,t=this.options.forceContext;return s(this.node);function s(i){if(i.nodeType===Node.TEXT_NODE)return[i.data];if(e&&!e(i))return[];var o=[""],a=0;if(i=i.firstChild)do{if(i.nodeType!==Node.TEXT_NODE){var r=s(i);t&&i.nodeType===Node.ELEMENT_NODE&&(!0===t||t(i))?(o[++a]=r,o[++a]=""):("string"==typeof r[0]&&(o[a]+=r.shift()),r.length&&(o[++a]=r,o[++a]=""))}else o[a]+=i.data}while(i=i.nextSibling);return o}},processMatches:function(){var e,t,s,i=this.matches,o=this.node,a=this.options.filterElements,r=[],n=o,d=i.shift(),l=0,u=0,c=[o];e:for(;;){if(n.nodeType===Node.TEXT_NODE&&(!t&&n.length+l>=d.endIndex?t={node:n,index:u++,text:n.data.substring(d.startIndex-l,d.endIndex-l),indexInMatch:0===l?0:l-d.startIndex,indexInNode:d.startIndex-l,endIndexInNode:d.endIndex-l,isEnd:!0}:e&&r.push({node:n,index:u++,text:n.data,indexInMatch:l-d.startIndex,indexInNode:0}),!e&&n.length+l>d.startIndex&&(e={node:n,index:u++,indexInMatch:0,indexInNode:d.startIndex-l,endIndexInNode:d.endIndex-l,text:n.data.substring(d.startIndex-l,d.endIndex-l)}),l+=n.data.length),s=n.nodeType===Node.ELEMENT_NODE&&a&&!a(n),e&&t){if(n=this.replaceMatch(d,e,r,t),l-=t.node.data.length-t.endIndexInNode,e=null,t=null,r=[],u=0,!(d=i.shift()))break}else if(!s&&(n.firstChild||n.nextSibling)){n.firstChild?(c.push(n),n=n.firstChild):n=n.nextSibling;continue}for(;;){if(n.nextSibling){n=n.nextSibling;break}if((n=c.pop())===o)break e}}},revert:function(){for(var e=this.reverts.length;e--;)this.reverts[e]();this.reverts=[]},prepareReplacementString:function(e,s,i){var o=this.options.portionMode;return o===t&&s.indexInMatch>0?"":(e=e.replace(/\$(\d+|&|`|')/g,(function(e,t){var s;switch(t){case"&":s=i[0];break;case"`":s=i.input.substring(0,i.startIndex);break;case"'":s=i.input.substring(i.endIndex);break;default:s=i[+t]||""}return s})),o===t?e:s.isEnd?e.substring(s.indexInMatch):e.substring(s.indexInMatch,s.indexInMatch+s.text.length))},getPortionReplacementNode:function(e,t){var i=this.options.replace||"$&";if("function"==typeof i)return(i=i(e,t))&&i.nodeType?i:s.createTextNode(String(i))},replaceMatch:function(e,t,i,o){var a,r,n=t.node,d=o.node;if(n===d){var l=n;t.indexInNode>0&&(a=s.createTextNode(l.data.substring(0,t.indexInNode)),l.parentNode.insertBefore(a,l));var u=this.getPortionReplacementNode(o,e);return l.parentNode.insertBefore(u,l),o.endIndexInNode<l.length&&(r=s.createTextNode(l.data.substring(o.endIndexInNode)),l.parentNode.insertBefore(r,l)),l.parentNode.removeChild(l),this.reverts.push((function(){a===u.previousSibling&&a.parentNode.removeChild(a),r===u.nextSibling&&r.parentNode.removeChild(r),u.parentNode.replaceChild(l,u)})),u}a=s.createTextNode(n.data.substring(0,t.indexInNode)),r=s.createTextNode(d.data.substring(o.endIndexInNode));for(var c=this.getPortionReplacementNode(t,e),h=[],p=0,m=i.length;p<m;++p){var f=i[p],b=this.getPortionReplacementNode(f,e);f.node.parentNode.replaceChild(b,f.node),this.reverts.push(function(e,t){return function(){t.parentNode.replaceChild(e.node,t)}}(f,b)),h.push(b)}var g=this.getPortionReplacementNode(o,e);return n.parentNode.insertBefore(a,n),n.parentNode.insertBefore(c,n),n.parentNode.removeChild(n),d.parentNode.insertBefore(g,d),d.parentNode.insertBefore(r,d),d.parentNode.removeChild(d),this.reverts.push((function(){a.parentNode.removeChild(a),c.parentNode.replaceChild(n,c),r.parentNode.removeChild(r),g.parentNode.replaceChild(d,g)})),g}},a}())}},t={};!function s(i){if(t[i])return t[i].exports;var o=t[i]={exports:{}};return e[i].call(o.exports,o,o.exports,s),o.exports}(392)})();